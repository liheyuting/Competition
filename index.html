<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025å¹´Q4 åŒ»ç–—è®¾å¤‡å¸‚åœºä¸ç«å“åˆ†ææŠ¥å‘Š - æ™ºèƒ½å¢å¼ºç‰ˆ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts (Noto Sans SC) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Placeholder Comments Required by Prompt -->
    <!-- Chosen Palette: Warm Neutral Professional. Background #F9FAFB (Gray-50), Text #374151 (Gray-700), Accents #0EA5E9 (Sky-500) and #0D9488 (Teal-600). Designed for clarity and reading comfort. -->
    
    <!-- Application Structure Plan: 
         The app uses a "Macro to Micro" flow. 
         1. Top Level: Global Navigation separates "Market Dynamics" and "Competition MarCom".
         2. Gemini Integration: Added smart action buttons that trigger LLM analysis for both market trends and competitor strategies.
         3. Dynamic Dashboard: Integrated a floating AI assistant for summary generation.
    -->
    
    <!-- Visualization & Content Choices:
         - Doughnut Chart for Market Drivers.
         - Radar Chart for Competitor focus.
         - AI-generated text blocks (using Gemini 2.5 Flash Preview).
         NO SVG graphics used. NO Mermaid JS used.
    -->
    
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #F9FAFB;
            color: #374151;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        
        @media (max-width: 640px) {
            .chart-container { height: 300px; }
        }

        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .active-tab { background-color: #0F766E; color: white; border-bottom: 3px solid #134E4A; }
        .inactive-tab { background-color: white; color: #4B5563; border-bottom: 3px solid transparent; }
        .inactive-tab:hover { background-color: #F3F4F6; color: #111827; }

        .loading-shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer { from { background-position: 200% 0; } to { background-position: -200% 0; } }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header / Hero -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 tracking-tight">2025 Q4 åŒ»ç–—è®¾å¤‡å¸‚åœºåˆ†æ <span class="text-teal-600">âœ¨ AI å¢å¼ºç‰ˆ</span></h1>
                    <p class="mt-2 text-sm text-gray-500">é›†æˆ Gemini 2.5 Flash æ·±åº¦è¯­ä¹‰æ´å¯Ÿä¸æ™ºèƒ½åˆ†æ</p>
                </div>
                <div class="mt-4 md:mt-0 flex space-x-2">
                    <span class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-teal-100 text-teal-800">Q4 å®æ—¶æƒ…æŠ¥</span>
                    <button onclick="generateReportSummary()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-sm text-sm font-medium">âœ¨ ç”Ÿæˆæœ¬é¡µæ€»ç»“</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="bg-white shadow sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-center space-x-8" aria-label="Tabs">
                <button id="nav-market" onclick="switchView('market')" class="active-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg transition-colors duration-200 w-1/2 md:w-auto text-center">ğŸ“Š å¸‚åœºåŠ¨æ€</button>
                <button id="nav-competition" onclick="switchView('competition')" class="inactive-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg transition-colors duration-200 w-1/2 md:w-auto text-center">ğŸ† ç«å“åˆ†æ</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Container -->
    <main class="flex-grow bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
        <div id="app-content" class="max-w-7xl mx-auto">
            <!-- Content Injected Here -->
        </div>
    </main>

    <!-- Floating AI Modal (Hidden by default) -->
    <div id="ai-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[100] hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[80vh]">
            <div class="p-4 border-b flex justify-between items-center bg-indigo-50">
                <h3 class="font-bold text-indigo-900 flex items-center"><span class="mr-2">âœ¨</span> Gemini æ™ºèƒ½åˆ†æå¼•æ“</h3>
                <button onclick="closeAIModal()" class="text-gray-500 hover:text-gray-800">âœ•</button>
            </div>
            <div id="ai-modal-content" class="p-6 overflow-y-auto custom-scroll text-gray-700 leading-relaxed space-y-4">
                <!-- AI Output here -->
            </div>
            <div class="p-4 bg-gray-50 border-t text-right">
                <button onclick="closeAIModal()" class="px-6 py-2 bg-white border rounded-lg text-sm font-medium shadow-sm hover:bg-gray-100">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-auto">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-sm text-gray-500">
                æ•°æ®æ¥æº: 2025 Q4 Competition MarCom Insights Report.
                <br>æœ¬é¡µé¢ç”± <b>Gemini 2.5 Flash Preview</b> æä¾›å®æ—¶æ·±åº¦åˆ†ææ”¯æŒã€‚
            </p>
        </div>
    </footer>

    <script>
        // --- 0. GEMINI API CONFIG ---
        const apiKey = ""; // Runtime provided
        const modelName = "gemini-2.5-flash-preview-09-2025";

        async function callGemini(prompt, useSearch = false) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: "ä½ æ˜¯ä¸€ä½èµ„æ·±çš„åŒ»ç–—å™¨æ¢°å¸‚åœºåˆ†æä¸“å®¶ï¼Œæ“…é•¿ä»MarComæ•°æ®ä¸­æå–æ´å¯Ÿã€‚è¯·ä½¿ç”¨ä¸“ä¸šã€ç®€æ´çš„ä¸­æ–‡å›ç­”ã€‚å¦‚æœæ˜¯å»ºè®®ï¼Œè¯·åŠ¡å¿…å…·æœ‰å¯æ‰§è¡Œæ€§ã€‚" }] }
            };
            if (useSearch) {
                payload.tools = [{ "google_search": {} }];
            }

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('API Error');
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text || "æŠ±æ­‰ï¼Œåˆ†æå¤±è´¥ã€‚";
                } catch (e) {
                    const delay = Math.pow(2, i) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
            return "è¿æ¥Geminiåˆ†ææœåŠ¡è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–é‡è¯•ã€‚";
        }

        // --- 1. DATA STORE ---
        const reportData = {
            market: {
                intro: "æœ¬æ¿å—èšç„¦2025å¹´ç¬¬å››å­£åº¦ä¸­å›½åŒ»ç–—è®¾å¤‡å¸‚åœºçš„å®è§‚ç¯å¢ƒã€‚æ ¸å¿ƒå˜åŒ–é›†ä¸­åœ¨åŒ»ä¿å®šä»·è§„åˆ™çš„é‡æ„ä¸AIæŠ€æœ¯åœ¨åŒ»ç–—åŸºå»ºä¸­çš„æ·±åº¦æ¸—é€ã€‚ä¼ä¸šéœ€æ ¹æ®â€œæŒ‰æ•ˆæœå®šä»·â€çš„æ–°è§„è°ƒæ•´äº§å“ç»„åˆç­–ç•¥ã€‚",
                dynamics: [
                    { title: "AI + Healthcare (AIåŒ»ç–—)", icon: "ğŸ¤–", desc: "AIæŠ€æœ¯ä¸å†æ˜¯æ¦‚å¿µï¼Œè€Œæ˜¯è¿›å…¥å®è´¨æ€§çš„åŸºå»ºé˜¶æ®µã€‚é‡ç‚¹åœ¨äºAIè¾…åŠ©è¯Šæ–­çš„åŒ»ä¿æ”¯ä»˜æ ‡å‡†ç¡®ç«‹ã€‚", tags: ["æ•°å­—åŒ–è½¬å‹", "è¾…åŠ©è¯Šæ–­"] },
                    { title: "Localization (æœ¬åœŸåŒ–ç”Ÿäº§)", icon: "ğŸ­", desc: "å—åœ°ç¼˜æ”¿æ²»ä¸ä¾›åº”é“¾å®‰å…¨å½±å“ï¼Œè·¨å›½ä¼ä¸šè¿›ä¸€æ­¥æ·±åŒ–â€œåœ¨ä¸­å›½ï¼Œä¸ºä¸­å›½â€æˆ˜ç•¥ã€‚", tags: ["ä¾›åº”é“¾å®‰å…¨", "å›½äº§æ›¿ä»£"] },
                    { title: "Pricing Rules (åŒ»ä¿å®šä»·æ–°è§„)", icon: "ğŸ’°", desc: "CT/MRIç­‰é¡¹ç›®å®šä»·é€»è¾‘å˜é©ã€‚æ¨è¡Œâ€œæŒ‰æ•ˆæœå®šä»·â€ä¸â€œæŠ€è€—åˆ†ç¦»â€ã€‚", tags: ["æŒ‰æ•ˆæœä»˜è´¹", "å¿ƒè„MRI"] }
                ],
                priorities: [ "å¼ºåŒ–é«˜ç«¯å¸‚åœºå·®å¼‚åŒ–", "é€‚åº”åŸºäºä»·å€¼çš„å®šä»·ä½“ç³»", "åŠ å¼ºæœ¬åœŸäº§ç ”åŒ»åˆä½œ", "èšç„¦ç»“æœé©±åŠ¨çš„è¥é”€" ],
                chartData: { labels: ['æ”¿ç­–', 'AI åˆ›æ–°', 'æˆæœ¬', 'æœ¬åœŸåŒ–'], data: [35, 30, 20, 15] }
            },
            competitors: [
                { id: "philips", name: "PHILIPS", color: "#0B5ED7", brandFocus: "AIèµ‹èƒ½å¥åº·ç§‘æŠ€ï¼›â€œåˆ›æ–°æ— ç•Œï¼Œå…³æ€€è‡³äº«â€ï¼›æœ¬åœŸåŒ–åˆä½œä¸å‘¨å¹´åº†ï¼›ç»¿è‰²åŒ»ç–—ã€‚", npi: ["CT7600 (å…‰è°±CT)", "Azurion å¹³å°"], channels: ["å®˜æ–¹å¾®ä¿¡", "å™¨æ¢°ä¹‹å®¶"], scores: { ai: 9, local: 8, csr: 9, npi: 7, eco: 6 } },
                { id: "ge", name: "GE HealthCare", color: "#6C3FD3", brandFocus: "ç²¾å‡†åŒ»ç–—+AIè½åœ°ï¼›éå…¬å¸‚åœºå¸ƒå±€ï¼›â€œç²‰çº¢è¡ŒåŠ¨â€ï¼›â€œæ— ç•Œåˆ›æ–°â€æˆ˜ç•¥ã€‚", npi: ["Apex Quantum CT", "SIGNA Hero MR"], channels: ["å®˜å¾®", "å¥åº·ç•Œ"], scores: { ai: 8, local: 9, csr: 9, npi: 9, eco: 7 } },
                { id: "siemens", name: "SIEMENS", color: "#EC6602", brandFocus: "æ— è¾å°„/å…‰å­è®¡æ•°åˆ›æ–°ï¼›åŒ»å­¦AIè½¬åŒ–ï¼›æœ¬åœŸç”Ÿäº§å æ¯”æå‡ï¼›ESGç›®æ ‡ã€‚", npi: ["NAEOTOM Alpha", "Free.Max"], channels: ["æ”¾å°„æ²™é¾™", "ä¸é¦™å›­"], scores: { ai: 8, local: 8, csr: 8, npi: 10, eco: 6 } },
                { id: "united", name: "UNITED IMAGING", color: "#18264D", brandFocus: "ä»‹å…¥è¯Šç–—çªç ´ï¼›æ•°æ™ºèåˆï¼›å…¨çº¿æ‰©å±•ï¼›äº§ç ”åŒ»ååŒã€‚", npi: ["uCT 960+", "uMR Jupiter"], channels: ["å®˜å¾®", "CMEF"], scores: { ai: 9, local: 10, csr: 6, npi: 9, eco: 8 } },
                { id: "mindray", name: "mindray", color: "#E60012", brandFocus: "å›½é™…åŒ–å¹¶è´­ï¼›â€œè®¾å¤‡+IT+AIâ€ç”Ÿæ€ï¼›è¿œç¨‹åŒ»ç–—ï¼›å…¨çƒæ•°å­—åŒ–ã€‚", npi: ["BeneVision Nç³»åˆ—", "Resona R9"], channels: ["æŠ•èµ„è€…å…³ç³»", "å®˜å¾®"], scores: { ai: 7, local: 9, csr: 7, npi: 8, eco: 10 } },
                { id: "neusoft", name: "Neusoft", color: "#007BFF", brandFocus: "é«˜ç«¯å½±åƒåˆ›æ–°ï¼›å…‰å­æŠ€æœ¯å‚¨å¤‡ï¼›äº§ç ”èåˆåˆä½œï¼›æ ¸å¿ƒç¡¬ä»¶è‡ªç ”ã€‚", npi: ["NeuViz Epoch", "NeuMR 1.5T"], channels: ["ç§‘ç ”æ–°é—»", "å®˜å¾®"], scores: { ai: 7, local: 10, csr: 6, npi: 8, eco: 9 } }
            ]
        };

        // --- 2. APP LOGIC ---
        let state = { currentView: 'market', selectedCompetitorId: 'philips' };
        let activeChart = null;

        function switchView(viewName) {
            state.currentView = viewName;
            document.getElementById('nav-market').className = viewName === 'market' ? "active-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg w-1/2 md:w-auto text-center" : "inactive-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg w-1/2 md:w-auto text-center";
            document.getElementById('nav-competition').className = viewName === 'competition' ? "active-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg w-1/2 md:w-auto text-center" : "inactive-tab whitespace-nowrap py-4 px-6 border-b-2 font-medium text-lg w-1/2 md:w-auto text-center";
            render();
        }

        function render() {
            const container = document.getElementById('app-content');
            container.innerHTML = '';
            container.classList.remove('fade-in');
            void container.offsetWidth;
            container.classList.add('fade-in');

            if (state.currentView === 'market') renderMarket();
            else renderCompetition();
        }

        // --- 3. UI RENDERERS ---
        function renderMarket() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="mb-8 bg-white p-6 rounded-lg shadow-sm border border-gray-100 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800 mb-2">ğŸ“Œ å¸‚åœºç¯å¢ƒç»¼è¿°</h2>
                        <p class="text-gray-600 leading-relaxed">${reportData.market.intro}</p>
                    </div>
                    <button onclick="analyzeMarketTrends()" class="flex-shrink-0 ml-4 px-4 py-3 bg-teal-600 text-white rounded-xl shadow-md hover:bg-teal-700 transition flex items-center">
                        <span class="mr-2">âœ¨</span> AI è¶‹åŠ¿æ´å¯Ÿ
                    </button>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-6">
                        ${reportData.market.dynamics.map(dyn => `
                            <div class="bg-white p-6 rounded-xl shadow border-l-4 border-teal-500">
                                <div class="flex items-start">
                                    <div class="text-3xl mr-4">${dyn.icon}</div>
                                    <div>
                                        <h3 class="font-bold text-gray-900">${dyn.title}</h3>
                                        <p class="text-sm text-gray-600 mt-1">${dyn.desc}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow flex flex-col items-center">
                        <h3 class="font-bold mb-4">é©±åŠ¨åŠ›åˆ†å¸ƒ</h3>
                        <div class="chart-container"><canvas id="marketChart"></canvas></div>
                    </div>
                </div>
            `;
            initMarketChart();
        }

        function renderCompetition() {
            const container = document.getElementById('app-content');
            const activeComp = reportData.competitors.find(c => c.id === state.selectedCompetitorId);

            container.innerHTML = `
                <div class="flex overflow-x-auto bg-white shadow-sm rounded-t-xl mb-1 custom-scroll">
                    ${reportData.competitors.map(c => `
                        <button onclick="state.selectedCompetitorId='${c.id}'; render();" 
                                class="px-6 py-4 font-bold whitespace-nowrap ${state.selectedCompetitorId === c.id ? 'border-b-4 border-teal-600 text-teal-700 bg-teal-50' : 'text-gray-500 hover:bg-gray-50'}">
                            ${c.name}
                        </button>
                    `).join('')}
                </div>
                <div class="bg-white p-8 rounded-b-xl shadow-sm border border-gray-100 grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="flex justify-between items-start">
                            <h2 class="text-2xl font-bold text-gray-900">${activeComp.name} æˆ˜ç•¥åˆ†æ</h2>
                            <button onclick="analyzeCompetitor('${activeComp.id}')" class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg font-bold hover:bg-indigo-200 transition">
                                âœ¨ æˆ˜ç•¥æ¨æ¼”
                            </button>
                        </div>
                        <div class="p-4 bg-gray-50 rounded-lg border">
                            <h4 class="font-bold mb-2">ğŸ“¢ å“ç‰Œç„¦ç‚¹</h4>
                            <p class="text-sm">${activeComp.brandFocus}</p>
                        </div>
                        <div>
                            <h4 class="font-bold mb-2">ğŸ†• æ ¸å¿ƒäº§å“ (NPI)</h4>
                            <div class="flex flex-wrap gap-2">${activeComp.npi.map(n => `<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-bold">${n}</span>`).join('')}</div>
                        </div>
                    </div>
                    <div class="flex flex-col items-center bg-gray-50 p-6 rounded-xl">
                        <h4 class="font-bold mb-4">èƒ½åŠ›åˆ†å¸ƒé›·è¾¾å›¾</h4>
                        <div class="chart-container"><canvas id="compRadarChart"></canvas></div>
                    </div>
                </div>
            `;
            initCompChart(activeComp);
        }

        // --- 4. CHARTS ---
        function initMarketChart() {
            setTimeout(() => {
                const ctx = document.getElementById('marketChart').getContext('2d');
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: reportData.market.chartData.labels,
                        datasets: [{ data: reportData.market.chartData.data, backgroundColor: ['#0F766E', '#0EA5E9', '#F59E0B', '#6366F1'] }]
                    },
                    options: { maintainAspectRatio: false }
                });
            }, 0);
        }

        function initCompChart(comp) {
            setTimeout(() => {
                const ctx = document.getElementById('compRadarChart').getContext('2d');
                const dims = ['ai', 'local', 'csr', 'npi', 'eco'];
                const data = dims.map(d => comp.scores[d]);
                if (activeChart) activeChart.destroy();
                activeChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['AI', 'æœ¬åœŸåŒ–', 'CSR', 'æ–°å“', 'ç”Ÿæ€'],
                        datasets: [{ label: comp.name, data: data, backgroundColor: 'rgba(14, 165, 233, 0.2)', borderColor: '#0EA5E9' }]
                    },
                    options: { maintainAspectRatio: false, scales: { r: { suggestMin: 0, suggestMax: 10 } } }
                });
            }, 0);
        }

        // --- 5. AI FEATURES ---
        async function analyzeMarketTrends() {
            openAIModal("æ­£åœ¨é€šè¿‡ Gemini æ·±åº¦åˆ†æ 2025 Q4 å¸‚åœºåŠ¨æ€...");
            const prompt = `æ ¹æ®ä»¥ä¸‹2025å¹´Q4å¸‚åœºæ•°æ®ï¼š${JSON.stringify(reportData.market)}ï¼Œè¯·åˆ†æâ€œåŒ»ä¿æ–°è§„â€å’Œâ€œAIåŸºå»ºâ€å¯¹è·¨å›½ä¼ä¸šçš„å…·ä½“æŒ‘æˆ˜ã€‚å¹¶ç»™å‡º3æ¡åº”å¯¹å»ºè®®ã€‚`;
            const result = await callGemini(prompt, true);
            updateAIModal(result);
        }

        async function analyzeCompetitor(id) {
            const comp = reportData.competitors.find(c => c.id === id);
            openAIModal(`æ­£åœ¨æ¨æ¼” ${comp.name} çš„å¸‚åœºè¿›æ”»ç­–ç•¥...`);
            const prompt = `åˆ†æä¼ä¸šï¼š${comp.name}ã€‚å“ç‰Œé‡ç‚¹ï¼š${comp.brandFocus}ã€‚æ ¸å¿ƒäº§å“ï¼š${comp.npi.join(',')}ã€‚åŸºäºè¿™äº›ä¿¡æ¯ï¼Œé¢„æµ‹å…¶2025 Q4åœ¨ä¸‰çº¿ä»¥ä¸‹åŸå¸‚å¸‚åœºçš„æ¸—é€æ‰‹æ®µã€‚`;
            const result = await callGemini(prompt);
            updateAIModal(result);
        }

        async function generateReportSummary() {
            openAIModal("æ­£åœ¨æ€»ç»“æ•´ç¯‡æŠ¥å‘Šæ ¸å¿ƒä»·å€¼ç‚¹...");
            const fullContent = JSON.stringify(reportData);
            const prompt = `è¿™æ˜¯ä¸€ä»½2025å¹´Q4åŒ»ç–—å™¨æ¢°æŠ¥å‘Šã€‚è¯·æå–5ä¸ªæœ€é‡è¦çš„â€œå…³é”®å‘ç°â€ï¼Œå¹¶ä¸ºè¥é”€VPå†™ä¸€å°150å­—ä»¥å†…çš„å†³ç­–ç®€æŠ¥ã€‚`;
            const result = await callGemini(prompt);
            updateAIModal(result);
        }

        // --- 6. MODAL CONTROL ---
        function openAIModal(initialText) {
            const modal = document.getElementById('ai-modal');
            const content = document.getElementById('ai-modal-content');
            content.innerHTML = `<div class="flex flex-col items-center space-y-4 py-10">
                <div class="w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin"></div>
                <p class="text-indigo-600 font-medium animate-pulse">${initialText}</p>
            </div>`;
            modal.classList.remove('hidden');
        }

        function updateAIModal(text) {
            const content = document.getElementById('ai-modal-content');
            // Basic markdown-like formatting for AI response
            const formatted = text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
            content.innerHTML = `<div class="prose max-w-none text-gray-800">${formatted}</div>`;
        }

        function closeAIModal() {
            document.getElementById('ai-modal').classList.add('hidden');
        }

        // Init
        render();
    </script>
</body>
</html>
